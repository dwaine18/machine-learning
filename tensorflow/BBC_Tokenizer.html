<html>
<head>
<title>main.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #0033b3;}
.s1 { color: #080808;}
.s2 { color: #067d17;}
.s3 { color: #1750eb;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
main.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">csv</span>
<span class="s0">from </span><span class="s1">tensorflow.keras.preprocessing.text </span><span class="s0">import </span><span class="s1">Tokenizer</span>
<span class="s0">from </span><span class="s1">tensorflow.keras.preprocessing.sequence </span><span class="s0">import </span><span class="s1">pad_sequences</span>

<span class="s1">stopwords = [ </span><span class="s2">&quot;a&quot;</span><span class="s1">, </span><span class="s2">&quot;about&quot;</span><span class="s1">, </span><span class="s2">&quot;above&quot;</span><span class="s1">, </span><span class="s2">&quot;after&quot;</span><span class="s1">, </span><span class="s2">&quot;again&quot;</span><span class="s1">, </span><span class="s2">&quot;against&quot;</span><span class="s1">, </span><span class="s2">&quot;all&quot;</span><span class="s1">, </span><span class="s2">&quot;am&quot;</span><span class="s1">, </span><span class="s2">&quot;an&quot;</span><span class="s1">, </span><span class="s2">&quot;and&quot;</span><span class="s1">, </span><span class="s2">&quot;any&quot;</span><span class="s1">, </span><span class="s2">&quot;are&quot;</span><span class="s1">, </span><span class="s2">&quot;as&quot;</span><span class="s1">, </span><span class="s2">&quot;at&quot;</span><span class="s1">, </span><span class="s2">&quot;be&quot;</span><span class="s1">, </span><span class="s2">&quot;because&quot;</span><span class="s1">, </span><span class="s2">&quot;been&quot;</span><span class="s1">, </span><span class="s2">&quot;before&quot;</span><span class="s1">, </span><span class="s2">&quot;being&quot;</span><span class="s1">, </span><span class="s2">&quot;below&quot;</span><span class="s1">, </span><span class="s2">&quot;between&quot;</span><span class="s1">, </span><span class="s2">&quot;both&quot;</span><span class="s1">, </span><span class="s2">&quot;but&quot;</span><span class="s1">, </span><span class="s2">&quot;by&quot;</span><span class="s1">, </span><span class="s2">&quot;could&quot;</span><span class="s1">, </span><span class="s2">&quot;did&quot;</span><span class="s1">, </span><span class="s2">&quot;do&quot;</span><span class="s1">, </span><span class="s2">&quot;does&quot;</span><span class="s1">, </span><span class="s2">&quot;doing&quot;</span><span class="s1">, </span><span class="s2">&quot;down&quot;</span><span class="s1">, </span><span class="s2">&quot;during&quot;</span><span class="s1">, </span><span class="s2">&quot;each&quot;</span><span class="s1">, </span><span class="s2">&quot;few&quot;</span><span class="s1">, </span><span class="s2">&quot;for&quot;</span><span class="s1">, </span><span class="s2">&quot;from&quot;</span><span class="s1">, </span><span class="s2">&quot;further&quot;</span><span class="s1">, </span><span class="s2">&quot;had&quot;</span><span class="s1">, </span><span class="s2">&quot;has&quot;</span><span class="s1">, </span><span class="s2">&quot;have&quot;</span><span class="s1">, </span><span class="s2">&quot;having&quot;</span><span class="s1">, </span><span class="s2">&quot;he&quot;</span><span class="s1">, </span><span class="s2">&quot;he'd&quot;</span><span class="s1">, </span><span class="s2">&quot;he'll&quot;</span><span class="s1">, </span><span class="s2">&quot;he's&quot;</span><span class="s1">, </span><span class="s2">&quot;her&quot;</span><span class="s1">, </span><span class="s2">&quot;here&quot;</span><span class="s1">, </span><span class="s2">&quot;here's&quot;</span><span class="s1">, </span><span class="s2">&quot;hers&quot;</span><span class="s1">, </span><span class="s2">&quot;herself&quot;</span><span class="s1">, </span><span class="s2">&quot;him&quot;</span><span class="s1">, </span><span class="s2">&quot;himself&quot;</span><span class="s1">, </span><span class="s2">&quot;his&quot;</span><span class="s1">, </span><span class="s2">&quot;how&quot;</span><span class="s1">, </span><span class="s2">&quot;how's&quot;</span><span class="s1">, </span><span class="s2">&quot;i&quot;</span><span class="s1">, </span><span class="s2">&quot;i'd&quot;</span><span class="s1">, </span><span class="s2">&quot;i'll&quot;</span><span class="s1">, </span><span class="s2">&quot;i'm&quot;</span><span class="s1">, </span><span class="s2">&quot;i've&quot;</span><span class="s1">, </span><span class="s2">&quot;if&quot;</span><span class="s1">, </span><span class="s2">&quot;in&quot;</span><span class="s1">, </span><span class="s2">&quot;into&quot;</span><span class="s1">, </span><span class="s2">&quot;is&quot;</span><span class="s1">, </span><span class="s2">&quot;it&quot;</span><span class="s1">, </span><span class="s2">&quot;it's&quot;</span><span class="s1">, </span><span class="s2">&quot;its&quot;</span><span class="s1">, </span><span class="s2">&quot;itself&quot;</span><span class="s1">, </span><span class="s2">&quot;let's&quot;</span><span class="s1">, </span><span class="s2">&quot;me&quot;</span><span class="s1">, </span><span class="s2">&quot;more&quot;</span><span class="s1">, </span><span class="s2">&quot;most&quot;</span><span class="s1">, </span><span class="s2">&quot;my&quot;</span><span class="s1">, </span><span class="s2">&quot;myself&quot;</span><span class="s1">, </span><span class="s2">&quot;nor&quot;</span><span class="s1">, </span><span class="s2">&quot;of&quot;</span><span class="s1">, </span><span class="s2">&quot;on&quot;</span><span class="s1">, </span><span class="s2">&quot;once&quot;</span><span class="s1">, </span><span class="s2">&quot;only&quot;</span><span class="s1">, </span><span class="s2">&quot;or&quot;</span><span class="s1">, </span><span class="s2">&quot;other&quot;</span><span class="s1">, </span><span class="s2">&quot;ought&quot;</span><span class="s1">, </span><span class="s2">&quot;our&quot;</span><span class="s1">, </span><span class="s2">&quot;ours&quot;</span><span class="s1">, </span><span class="s2">&quot;ourselves&quot;</span><span class="s1">, </span><span class="s2">&quot;out&quot;</span><span class="s1">, </span><span class="s2">&quot;over&quot;</span><span class="s1">, </span><span class="s2">&quot;own&quot;</span><span class="s1">, </span><span class="s2">&quot;same&quot;</span><span class="s1">, </span><span class="s2">&quot;she&quot;</span><span class="s1">, </span><span class="s2">&quot;she'd&quot;</span><span class="s1">, </span><span class="s2">&quot;she'll&quot;</span><span class="s1">, </span><span class="s2">&quot;she's&quot;</span><span class="s1">, </span><span class="s2">&quot;should&quot;</span><span class="s1">, </span><span class="s2">&quot;so&quot;</span><span class="s1">, </span><span class="s2">&quot;some&quot;</span><span class="s1">, </span><span class="s2">&quot;such&quot;</span><span class="s1">, </span><span class="s2">&quot;than&quot;</span><span class="s1">, </span><span class="s2">&quot;that&quot;</span><span class="s1">, </span><span class="s2">&quot;that's&quot;</span><span class="s1">, </span><span class="s2">&quot;the&quot;</span><span class="s1">, </span><span class="s2">&quot;their&quot;</span><span class="s1">, </span><span class="s2">&quot;theirs&quot;</span><span class="s1">, </span><span class="s2">&quot;them&quot;</span><span class="s1">, </span><span class="s2">&quot;themselves&quot;</span><span class="s1">, </span><span class="s2">&quot;then&quot;</span><span class="s1">, </span><span class="s2">&quot;there&quot;</span><span class="s1">, </span><span class="s2">&quot;there's&quot;</span><span class="s1">, </span><span class="s2">&quot;these&quot;</span><span class="s1">, </span><span class="s2">&quot;they&quot;</span><span class="s1">, </span><span class="s2">&quot;they'd&quot;</span><span class="s1">, </span><span class="s2">&quot;they'll&quot;</span><span class="s1">, </span><span class="s2">&quot;they're&quot;</span><span class="s1">, </span><span class="s2">&quot;they've&quot;</span><span class="s1">, </span><span class="s2">&quot;this&quot;</span><span class="s1">, </span><span class="s2">&quot;those&quot;</span><span class="s1">, </span><span class="s2">&quot;through&quot;</span><span class="s1">, </span><span class="s2">&quot;to&quot;</span><span class="s1">, </span><span class="s2">&quot;too&quot;</span><span class="s1">, </span><span class="s2">&quot;under&quot;</span><span class="s1">, </span><span class="s2">&quot;until&quot;</span><span class="s1">, </span><span class="s2">&quot;up&quot;</span><span class="s1">, </span><span class="s2">&quot;very&quot;</span><span class="s1">, </span><span class="s2">&quot;was&quot;</span><span class="s1">, </span><span class="s2">&quot;we&quot;</span><span class="s1">, </span><span class="s2">&quot;we'd&quot;</span><span class="s1">, </span><span class="s2">&quot;we'll&quot;</span><span class="s1">, </span><span class="s2">&quot;we're&quot;</span><span class="s1">, </span><span class="s2">&quot;we've&quot;</span><span class="s1">, </span><span class="s2">&quot;were&quot;</span><span class="s1">, </span><span class="s2">&quot;what&quot;</span><span class="s1">, </span><span class="s2">&quot;what's&quot;</span><span class="s1">, </span><span class="s2">&quot;when&quot;</span><span class="s1">, </span><span class="s2">&quot;when's&quot;</span><span class="s1">, </span><span class="s2">&quot;where&quot;</span><span class="s1">, </span><span class="s2">&quot;where's&quot;</span><span class="s1">, </span><span class="s2">&quot;which&quot;</span><span class="s1">, </span><span class="s2">&quot;while&quot;</span><span class="s1">, </span><span class="s2">&quot;who&quot;</span><span class="s1">, </span><span class="s2">&quot;who's&quot;</span><span class="s1">, </span><span class="s2">&quot;whom&quot;</span><span class="s1">, </span><span class="s2">&quot;why&quot;</span><span class="s1">, </span><span class="s2">&quot;why's&quot;</span><span class="s1">, </span><span class="s2">&quot;with&quot;</span><span class="s1">, </span><span class="s2">&quot;would&quot;</span><span class="s1">, </span><span class="s2">&quot;you&quot;</span><span class="s1">, </span><span class="s2">&quot;you'd&quot;</span><span class="s1">, </span><span class="s2">&quot;you'll&quot;</span><span class="s1">, </span><span class="s2">&quot;you're&quot;</span><span class="s1">, </span><span class="s2">&quot;you've&quot;</span><span class="s1">, </span><span class="s2">&quot;your&quot;</span><span class="s1">, </span><span class="s2">&quot;yours&quot;</span><span class="s1">, </span><span class="s2">&quot;yourself&quot;</span><span class="s1">, </span><span class="s2">&quot;yourselves&quot; </span><span class="s1">]</span>


<span class="s1">sentences = []</span>
<span class="s1">labels = []</span>

<span class="s0">with </span><span class="s1">open(</span><span class="s2">&quot;/home/completeshoppe/Downloads/bbc-text.csv&quot;</span><span class="s1">, </span><span class="s2">'r'</span><span class="s1">) </span><span class="s0">as </span><span class="s1">csvfile:</span>
    <span class="s1">reader = csv.reader(csvfile, delimiter=</span><span class="s2">','</span><span class="s1">)</span>
    <span class="s1">next(reader)</span>
    <span class="s0">for </span><span class="s1">row </span><span class="s0">in </span><span class="s1">reader:</span>
        <span class="s1">labels.append(row[</span><span class="s3">0</span><span class="s1">])</span>
        <span class="s1">sentence = row[</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s0">for </span><span class="s1">word </span><span class="s0">in </span><span class="s1">stopwords:</span>
            <span class="s1">token = </span><span class="s2">&quot; &quot; </span><span class="s1">+ word + </span><span class="s2">&quot; &quot;</span>
            <span class="s1">sentence = sentence.replace(token, </span><span class="s2">&quot; &quot;</span><span class="s1">)</span>
            <span class="s1">sentence = sentence.replace(</span><span class="s2">&quot;  &quot;</span><span class="s1">, </span><span class="s2">&quot; &quot;</span><span class="s1">)</span>
        <span class="s1">sentences.append(sentence)</span>
<span class="s1">print(len(sentences))</span>
<span class="s1">print(sentences[</span><span class="s3">0</span><span class="s1">])</span>


<span class="s1">tokenizer = Tokenizer(oov_token=</span><span class="s2">&quot;&lt;OOV&gt;&quot;</span><span class="s1">)</span>
<span class="s1">tokenizer.fit_on_texts(sentences)</span>
<span class="s1">word_index = tokenizer.word_index</span>
<span class="s1">print(len(word_index))</span>


<span class="s1">sequences = tokenizer.texts_to_sequences(sentences)</span>
<span class="s1">padded = pad_sequences(sequences, padding=</span><span class="s2">'post'</span><span class="s1">)</span>
<span class="s1">print(padded[</span><span class="s3">0</span><span class="s1">])</span>
<span class="s1">print(padded.shape)</span>

<span class="s1">label_tokenizer = Tokenizer()</span>
<span class="s1">label_tokenizer.fit_on_texts(labels)</span>
<span class="s1">label_word_index = label_tokenizer.word_index</span>
<span class="s1">label_seq = label_tokenizer.texts_to_sequences(labels)</span>

<span class="s1">print(label_seq)</span>
<span class="s1">print(label_word_index)</span>
</pre>
</body>
</html>